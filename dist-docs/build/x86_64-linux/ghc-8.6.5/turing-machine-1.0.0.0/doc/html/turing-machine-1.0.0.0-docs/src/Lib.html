<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
    Lib.hs - Library to construct and use a Turing machine

    (C) 2020 Tim Gravert &lt;crazymind102@googlemail.com&gt;

    License: BSD 3-Clause
-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Lib</span><span>
</span><a name="line-14"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Lib.html#count1s"><span class="hs-identifier hs-var">count1s</span></a><span>
</span><a name="line-15"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">(</span><a href="Lib.html#L"><span class="hs-identifier hs-var">L</span></a><span class="hs-special">,</span><a href="Lib.html#R"><span class="hs-identifier hs-var">R</span></a><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Lib.html#run"><span class="hs-identifier hs-var">run</span></a><span>
</span><a name="line-17"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Lib.html#runP"><span class="hs-identifier hs-var">runP</span></a><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Lib.html#State"><span class="hs-identifier hs-type">State</span></a><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Lib.html#step"><span class="hs-identifier hs-var">step</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Lib.html#stepP"><span class="hs-identifier hs-var">stepP</span></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Lib.html#Table"><span class="hs-identifier hs-type">Table</span></a><span class="hs-special">(</span><a href="Lib.html#Table"><span class="hs-identifier hs-var">Table</span></a><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Lib.html#Tape"><span class="hs-identifier hs-type">Tape</span></a><span class="hs-special">(</span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Lib.html#toMove"><span class="hs-identifier hs-var">toMove</span></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Char</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Yaml</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.Generics</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- |The implementation of the Turing machine.</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- The Turing machine has three values: the State it is in, the table of</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- instructions and the tape.</span><span>
</span><a name="line-40"></a><span class="hs-keyword">data</span><span> </span><a name="TuringMachine"><a href="Lib.html#TuringMachine"><span class="hs-identifier">TuringMachine</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TM"><a href="Lib.html#TM"><span class="hs-identifier">TM</span></a></a><span> </span><a href="Lib.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="Lib.html#Table"><span class="hs-identifier hs-type">Table</span></a><span> </span><a href="Lib.html#Tape"><span class="hs-identifier hs-type">Tape</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- |The State of the Turing machine is saved as a String.</span><span>
</span><a name="line-43"></a><span class="hs-keyword">type</span><span> </span><a name="State"><a href="Lib.html#State"><span class="hs-identifier">State</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-comment">-- |Implementation of the movement of the head of the Turing machine.</span><span>
</span><a name="line-46"></a><span class="hs-keyword">data</span><span> </span><a name="Move"><a href="Lib.html#Move"><span class="hs-identifier">Move</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-comment">-- |L is used to move the head of the Turing machine to the left.</span><span>
</span><a name="line-48"></a><span>    </span><a name="L"><a href="Lib.html#L"><span class="hs-identifier">L</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-comment">-- |R is used to move the head of the Turing machine to the right.</span><span>
</span><a name="line-50"></a><span>    </span><a name="R"><a href="Lib.html#R"><span class="hs-identifier">R</span></a></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-identifier">toMove</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span>
</span><a name="line-54"></a><a name="toMove"><a href="Lib.html#toMove"><span class="hs-identifier">toMove</span></a></a><span> </span><span class="hs-string">&quot;L&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="Lib.html#L"><span class="hs-identifier hs-var">L</span></a><span>
</span><a name="line-55"></a><span class="hs-identifier">toMove</span><span> </span><span class="hs-string">&quot;R&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="Lib.html#R"><span class="hs-identifier hs-var">R</span></a><span>
</span><a name="line-56"></a><span class="hs-identifier">toMove</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">-- |Implementation of the table of instructions.</span><span>
</span><a name="line-59"></a><span class="hs-comment">-- The States of the Turing machine are the keys of a Map.</span><span>
</span><a name="line-60"></a><span class="hs-comment">-- The values of this Map are the instructions.</span><span>
</span><a name="line-61"></a><span class="hs-comment">-- The instructions are another Map.</span><span>
</span><a name="line-62"></a><span class="hs-comment">-- The keys of that Map are the read Symbol.</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- The values of that Map are a tuple which tells the Turing machine what</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- to do.</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- The first element of the tuple is the Symbol to write.</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- The second element is the movement the head has to perform.</span><span>
</span><a name="line-67"></a><span class="hs-comment">-- The third element is the State in which the Turing machine switches</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- afterwads.</span><span>
</span><a name="line-69"></a><span class="hs-keyword">data</span><span> </span><a name="Table"><a href="Lib.html#Table"><span class="hs-identifier">Table</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Table"><a href="Lib.html#Table"><span class="hs-identifier">Table</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M.Map</span><span> </span><a href="Lib.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M.Map</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">,</span><span> </span><a href="Lib.html#State"><span class="hs-identifier hs-type">State</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- |Implementation of the tape of the Turing machine. The Symbols are</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- stored in two Strings and a Char.</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- The String on the left is the tape left of the head and the String on</span><span>
</span><a name="line-74"></a><span class="hs-comment">-- the right is the tape right of the head.</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- The Char is the Symbol the head is over at a given moment.</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- In this implementation of a Turing machine the head is part of the tape</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- itself.</span><span>
</span><a name="line-78"></a><span class="hs-keyword">data</span><span> </span><a name="Tape"><a href="Lib.html#Tape"><span class="hs-identifier">Tape</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Tape"><a href="Lib.html#Tape"><span class="hs-identifier">Tape</span></a></a><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- |Instance of Show for TuringMachine</span><span>
</span><a name="line-82"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-83"></a><span>    </span><a name="local-8214565720323791090"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><a name="local-6989586621679045452"><a href="#local-6989586621679045452"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679045453"><a href="#local-6989586621679045453"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621679045454"><a href="#local-6989586621679045454"><span class="hs-identifier">tp</span></a></a><span> </span><a name="local-6989586621679045455"><a href="#local-6989586621679045455"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;TM\nState: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679045452"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;Steps: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679045455"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679045453"><span class="hs-identifier hs-var">ta</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679045454"><span class="hs-identifier hs-var">tp</span></a><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- |Instance of Show for Table</span><span>
</span><a name="line-86"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Lib.html#Table"><span class="hs-identifier hs-type">Table</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-87"></a><span>    </span><a name="local-8214565720323791090"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#Table"><span class="hs-identifier hs-var">Table</span></a><span> </span><a name="local-6989586621679045260"><a href="#local-6989586621679045260"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">M.null</span><span> </span><a href="#local-6989586621679045260"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-89"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679045261"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;:  &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679045262"><span class="hs-identifier hs-var">tst</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Lib.html#Table"><span class="hs-identifier hs-var">Table</span></a><span> </span><a href="#local-6989586621679045263"><span class="hs-identifier hs-var">nts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679045261"><a href="#local-6989586621679045261"><span class="hs-identifier">h</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.keys</span><span> </span><a href="#local-6989586621679045260"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>                  </span><a name="local-6989586621679045262"><a href="#local-6989586621679045262"><span class="hs-identifier">tst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#showSymbols"><span class="hs-identifier hs-var">showSymbols</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.toList</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679045260"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-operator hs-var">M.!</span><span> </span><a href="#local-6989586621679045261"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>                  </span><a name="local-6989586621679045263"><a href="#local-6989586621679045263"><span class="hs-identifier">nts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M.delete</span><span> </span><a href="#local-6989586621679045261"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679045260"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- showSymbols and its helper function showSymbols' are helpers for the</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- Instance of Show for Table</span><span>
</span><a name="line-96"></a><span class="hs-identifier">showSymbols</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-97"></a><a name="showSymbols"><a href="Lib.html#showSymbols"><span class="hs-identifier">showSymbols</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-98"></a><span class="hs-identifier">showSymbols</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679045507"><a href="#local-6989586621679045507"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679045508"><a href="#local-6989586621679045508"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Lib.html#showSymbols%27"><span class="hs-identifier hs-var">showSymbols'</span></a><span> </span><a href="#local-6989586621679045507"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><a href="Lib.html#showSymbols"><span class="hs-identifier hs-var">showSymbols</span></a><span> </span><a href="#local-6989586621679045508"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span class="hs-identifier">showSymbols'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-100"></a><a name="showSymbols%27"><a href="Lib.html#showSymbols%27"><span class="hs-identifier">showSymbols'</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679045509"><a href="#local-6989586621679045509"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span class="hs-special">(</span><a name="local-6989586621679045510"><a href="#local-6989586621679045510"><span class="hs-identifier">y0</span></a></a><span class="hs-special">,</span><a name="local-6989586621679045511"><a href="#local-6989586621679045511"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679045512"><a href="#local-6989586621679045512"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679045509"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679045510"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679045511"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679045512"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)\t&quot;</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">-- |Instance of Show for Move.</span><span>
</span><a name="line-103"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-104"></a><span>    </span><a name="local-8214565720323791090"><span class="hs-identifier">show</span></a><span> </span><a href="Lib.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;L&quot;</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="Lib.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;R&quot;</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- |Instance of Show for Tape.</span><span>
</span><a name="line-108"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Lib.html#Tape"><span class="hs-identifier hs-type">Tape</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-109"></a><span>    </span><a name="local-8214565720323791090"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span> </span><a name="local-6989586621679045257"><a href="#local-6989586621679045257"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679045258"><a href="#local-6989586621679045258"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679045259"><a href="#local-6989586621679045259"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.append</span><span> </span><a href="#local-6989586621679045257"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.append</span><span> </span><span class="hs-string">&quot;[&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.cons</span><span> </span><a href="#local-6989586621679045258"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.append</span><span> </span><span class="hs-string">&quot;]&quot;</span><span> </span><a href="#local-6989586621679045259"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">--instance FromJSON Move</span><span>
</span><a name="line-113"></a><span class="hs-comment">--instance ToJSON Move</span><span>
</span><a name="line-114"></a><span class="hs-comment">-- Helper functions to read out the Table values</span><span>
</span><a name="line-115"></a><span class="hs-identifier">fstC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">,</span><span> </span><a href="Lib.html#State"><span class="hs-identifier hs-type">State</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-116"></a><a name="fstC"><a href="Lib.html#fstC"><span class="hs-identifier">fstC</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679045513"><a href="#local-6989586621679045513"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679045513"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-identifier">sndC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">,</span><span> </span><a href="Lib.html#State"><span class="hs-identifier hs-type">State</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span>
</span><a name="line-119"></a><a name="sndC"><a href="Lib.html#sndC"><span class="hs-identifier">sndC</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679045514"><a href="#local-6989586621679045514"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679045514"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-identifier">trdC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">,</span><span> </span><a href="Lib.html#State"><span class="hs-identifier hs-type">State</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#State"><span class="hs-identifier hs-type">State</span></a><span>
</span><a name="line-122"></a><a name="trdC"><a href="Lib.html#trdC"><span class="hs-identifier">trdC</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679045515"><a href="#local-6989586621679045515"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679045515"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- |This function moves the head of the Turing machine.</span><span>
</span><a name="line-126"></a><span class="hs-identifier">move</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#Move"><span class="hs-identifier hs-type">Move</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#Tape"><span class="hs-identifier hs-type">Tape</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#Tape"><span class="hs-identifier hs-type">Tape</span></a><span>
</span><a name="line-127"></a><a name="move"><a href="Lib.html#move"><span class="hs-identifier">move</span></a></a><span> </span><a name="local-6989586621679045516"><a href="#local-6989586621679045516"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span> </span><a name="local-6989586621679045517"><a href="#local-6989586621679045517"><span class="hs-identifier">lt</span></a></a><span> </span><a name="local-6989586621679045518"><a href="#local-6989586621679045518"><span class="hs-identifier">pos</span></a></a><span> </span><a name="local-6989586621679045519"><a href="#local-6989586621679045519"><span class="hs-identifier">rt</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679045516"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Lib.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">T.length</span><span> </span><a href="#local-6989586621679045517"><span class="hs-identifier hs-var">lt</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">[</span><span class="hs-char">'0'</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-char">'0'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.cons</span><span> </span><a href="#local-6989586621679045518"><span class="hs-identifier hs-var">pos</span></a><span> </span><a href="#local-6989586621679045519"><span class="hs-identifier hs-var">rt</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679045516"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Lib.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.init</span><span> </span><a href="#local-6989586621679045517"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.last</span><span> </span><a href="#local-6989586621679045517"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.cons</span><span> </span><a href="#local-6989586621679045518"><span class="hs-identifier hs-var">pos</span></a><span> </span><a href="#local-6989586621679045519"><span class="hs-identifier hs-var">rt</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679045516"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Lib.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">T.length</span><span> </span><a href="#local-6989586621679045519"><span class="hs-identifier hs-var">rt</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.snoc</span><span> </span><a href="#local-6989586621679045517"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679045518"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">)</span><span> </span><span class="hs-char">'0'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">[</span><span class="hs-char">'0'</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679045516"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Lib.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.snoc</span><span> </span><a href="#local-6989586621679045517"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679045518"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.head</span><span> </span><a href="#local-6989586621679045519"><span class="hs-identifier hs-var">rt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.tail</span><span> </span><a href="#local-6989586621679045519"><span class="hs-identifier hs-var">rt</span></a><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- |Each step of the Turing machine is implemented in this function.</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- It returns the resulting Turing machine.</span><span>
</span><a name="line-135"></a><span class="hs-identifier">step</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span>
</span><a name="line-136"></a><a name="step"><a href="Lib.html#step"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><span class="hs-string">&quot;HALT&quot;</span><span> </span><a name="local-6989586621679045520"><a href="#local-6989586621679045520"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621679045521"><a href="#local-6989586621679045521"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621679045522"><a href="#local-6989586621679045522"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><span class="hs-string">&quot;HALT&quot;</span><span> </span><a href="#local-6989586621679045520"><span class="hs-identifier hs-var">ta</span></a><span> </span><a href="#local-6989586621679045521"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679045522"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span class="hs-identifier">step</span><span> </span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><a name="local-6989586621679045602"><a href="#local-6989586621679045602"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Lib.html#Table"><span class="hs-identifier hs-var">Table</span></a><span> </span><a name="local-6989586621679045603"><a href="#local-6989586621679045603"><span class="hs-identifier">ta</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span> </span><a name="local-6989586621679045604"><a href="#local-6989586621679045604"><span class="hs-identifier">lt</span></a></a><span> </span><a name="local-6989586621679045605"><a href="#local-6989586621679045605"><span class="hs-identifier">pos</span></a></a><span> </span><a name="local-6989586621679045606"><a href="#local-6989586621679045606"><span class="hs-identifier">rt</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679045607"><a href="#local-6989586621679045607"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#trdC"><span class="hs-identifier hs-var">trdC</span></a><span> </span><a href="#local-6989586621679045608"><span class="hs-identifier hs-var">card</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lib.html#Table"><span class="hs-identifier hs-var">Table</span></a><span> </span><a href="#local-6989586621679045603"><span class="hs-identifier hs-var">ta</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lib.html#move"><span class="hs-identifier hs-var">move</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#sndC"><span class="hs-identifier hs-var">sndC</span></a><span> </span><a href="#local-6989586621679045608"><span class="hs-identifier hs-var">card</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span> </span><a href="#local-6989586621679045604"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679045609"><span class="hs-identifier hs-var">uPos</span></a><span> </span><a href="#local-6989586621679045606"><span class="hs-identifier hs-var">rt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679045607"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679045608"><a href="#local-6989586621679045608"><span class="hs-identifier">card</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679045603"><span class="hs-identifier hs-var">ta</span></a><span> </span><span class="hs-operator hs-var">M.!</span><span> </span><a href="#local-6989586621679045602"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">M.!</span><span> </span><a href="#local-6989586621679045605"><span class="hs-identifier hs-var">pos</span></a><span>
</span><a name="line-139"></a><span>          </span><a name="local-6989586621679045609"><a href="#local-6989586621679045609"><span class="hs-identifier">uPos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#fstC"><span class="hs-identifier hs-var">fstC</span></a><span> </span><a href="#local-6989586621679045608"><span class="hs-identifier hs-var">card</span></a><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- |Version of step that prints the result.</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- It is intented for only a single step.</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- For a complete run that should be printed use runP.</span><span>
</span><a name="line-144"></a><span class="hs-identifier">stepP</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span>
</span><a name="line-145"></a><a name="stepP"><a href="Lib.html#stepP"><span class="hs-identifier">stepP</span></a></a><span> </span><a name="local-6989586621679045610"><a href="#local-6989586621679045610"><span class="hs-identifier">tm</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><span class="hs-string">&quot;HALT&quot;</span><span> </span><a name="local-6989586621679045611"><a href="#local-6989586621679045611"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621679045612"><a href="#local-6989586621679045612"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621679045613"><a href="#local-6989586621679045613"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679045610"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-146"></a><span class="hs-identifier">stepP</span><span> </span><a name="local-6989586621679045614"><a href="#local-6989586621679045614"><span class="hs-identifier">tm</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><a name="local-6989586621679045615"><a href="#local-6989586621679045615"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Lib.html#Table"><span class="hs-identifier hs-var">Table</span></a><span> </span><a name="local-6989586621679045616"><a href="#local-6989586621679045616"><span class="hs-identifier">ta</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span> </span><a name="local-6989586621679045617"><a href="#local-6989586621679045617"><span class="hs-identifier">lt</span></a></a><span> </span><a name="local-6989586621679045618"><a href="#local-6989586621679045618"><span class="hs-identifier">pos</span></a></a><span> </span><a name="local-6989586621679045619"><a href="#local-6989586621679045619"><span class="hs-identifier">rt</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679045620"><a href="#local-6989586621679045620"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-147"></a><span>    </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-identifier hs-var">putStr</span><span> </span><span class="hs-string">&quot;State: &quot;</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-special">(</span><a href="Lib.html#getState"><span class="hs-identifier hs-var">getState</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#step"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679045614"><span class="hs-identifier hs-var">tm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>    </span><span class="hs-identifier hs-var">putStr</span><span> </span><span class="hs-string">&quot;Step: &quot;</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679045620"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>    </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-special">(</span><a href="Lib.html#getTape"><span class="hs-identifier hs-var">getTape</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#step"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679045614"><span class="hs-identifier hs-var">tm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Lib.html#step"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679045614"><span class="hs-identifier hs-var">tm</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- |Running the Turing machine without any output until the Turing machine</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- halts.</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- It returns the finished Turing machine.</span><span>
</span><a name="line-159"></a><span class="hs-identifier">run</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span>
</span><a name="line-160"></a><a name="run"><a href="Lib.html#run"><span class="hs-identifier">run</span></a></a><span> </span><a name="local-6989586621679045794"><a href="#local-6989586621679045794"><span class="hs-identifier">tm</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><span class="hs-string">&quot;HALT&quot;</span><span> </span><a name="local-6989586621679045795"><a href="#local-6989586621679045795"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621679045796"><a href="#local-6989586621679045796"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621679045797"><a href="#local-6989586621679045797"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679045794"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-161"></a><span class="hs-identifier">run</span><span> </span><a name="local-6989586621679045798"><a href="#local-6989586621679045798"><span class="hs-identifier">tm</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><a name="local-6989586621679045799"><a href="#local-6989586621679045799"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679045800"><a href="#local-6989586621679045800"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621679045801"><a href="#local-6989586621679045801"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621679045802"><a href="#local-6989586621679045802"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#step"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679045798"><span class="hs-identifier hs-var">tm</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- |Version of `run` that prints the results after each step.</span><span>
</span><a name="line-165"></a><span class="hs-identifier">runP</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span>
</span><a name="line-166"></a><a name="runP"><a href="Lib.html#runP"><span class="hs-identifier">runP</span></a></a><span> </span><a name="local-6989586621679045803"><a href="#local-6989586621679045803"><span class="hs-identifier">tm</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><span class="hs-string">&quot;HALT&quot;</span><span> </span><a name="local-6989586621679045804"><a href="#local-6989586621679045804"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621679045805"><a href="#local-6989586621679045805"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621679045806"><a href="#local-6989586621679045806"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679045803"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-167"></a><span class="hs-identifier">runP</span><span> </span><a name="local-6989586621679045807"><a href="#local-6989586621679045807"><span class="hs-identifier">tm</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><a name="local-6989586621679045808"><a href="#local-6989586621679045808"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679045809"><a href="#local-6989586621679045809"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621679045810"><a href="#local-6989586621679045810"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621679045811"><a href="#local-6989586621679045811"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-169"></a><span>    </span><span class="hs-identifier hs-var">putStr</span><span> </span><span class="hs-string">&quot;State: &quot;</span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-special">(</span><a href="Lib.html#getState"><span class="hs-identifier hs-var">getState</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#step"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679045807"><span class="hs-identifier hs-var">tm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>    </span><span class="hs-identifier hs-var">putStr</span><span> </span><span class="hs-string">&quot;Step: &quot;</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679045811"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-173"></a><span>    </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-special">(</span><a href="Lib.html#getTape"><span class="hs-identifier hs-var">getTape</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#step"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679045807"><span class="hs-identifier hs-var">tm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>    </span><a name="local-6989586621679045812"><a href="#local-6989586621679045812"><span class="hs-identifier">ntm</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lib.html#runP"><span class="hs-identifier hs-var">runP</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#step"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679045807"><span class="hs-identifier hs-var">tm</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679045812"><span class="hs-identifier hs-var">ntm</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-identifier">getTape</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#Tape"><span class="hs-identifier hs-type">Tape</span></a><span>
</span><a name="line-179"></a><a name="getTape"><a href="Lib.html#getTape"><span class="hs-identifier">getTape</span></a></a><span> </span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><a name="local-6989586621679045813"><a href="#local-6989586621679045813"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679045814"><a href="#local-6989586621679045814"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621679045815"><a href="#local-6989586621679045815"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621679045816"><a href="#local-6989586621679045816"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679045815"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-identifier">getState</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#State"><span class="hs-identifier hs-type">State</span></a><span>
</span><a name="line-182"></a><a name="getState"><a href="Lib.html#getState"><span class="hs-identifier">getState</span></a></a><span> </span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><a name="local-6989586621679045817"><a href="#local-6989586621679045817"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679045818"><a href="#local-6989586621679045818"><span class="hs-identifier">ta</span></a></a><span> </span><a name="local-6989586621679045819"><a href="#local-6989586621679045819"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621679045820"><a href="#local-6989586621679045820"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679045817"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- |Function to count the ones on the tape.</span><span>
</span><a name="line-186"></a><span class="hs-comment">-- It is primaly good to be used for Busy Beavers and similar programs.</span><span>
</span><a name="line-187"></a><span class="hs-identifier">count1s</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-188"></a><a name="count1s"><a href="Lib.html#count1s"><span class="hs-identifier">count1s</span></a></a><span> </span><span class="hs-special">(</span><a href="Lib.html#TM"><span class="hs-identifier hs-var">TM</span></a><span> </span><a name="local-6989586621679045821"><a href="#local-6989586621679045821"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679045822"><a href="#local-6989586621679045822"><span class="hs-identifier">ta</span></a></a><span> </span><span class="hs-special">(</span><a href="Lib.html#Tape"><span class="hs-identifier hs-var">Tape</span></a><span> </span><a name="local-6989586621679045823"><a href="#local-6989586621679045823"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679045824"><a href="#local-6989586621679045824"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679045825"><a href="#local-6989586621679045825"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679045826"><a href="#local-6989586621679045826"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679045827"><span class="hs-identifier hs-var">nxs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679045829"><span class="hs-identifier hs-var">ny</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679045828"><span class="hs-identifier hs-var">nzs</span></a><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679045827"><a href="#local-6989586621679045827"><span class="hs-identifier">nxs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">digitToInt</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679045823"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>          </span><a name="local-6989586621679045828"><a href="#local-6989586621679045828"><span class="hs-identifier">nzs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">digitToInt</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679045825"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span>          </span><a name="local-6989586621679045829"><a href="#local-6989586621679045829"><span class="hs-identifier">ny</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">digitToInt</span><span> </span><a href="#local-6989586621679045824"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-192"></a></pre></body></html>